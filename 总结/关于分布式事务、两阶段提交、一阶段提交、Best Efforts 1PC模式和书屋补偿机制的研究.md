##   1.  XA 
XA是由X/Open组织提出的分布式事务的规范。XA规范主要定义了（全局）事务管理器（Transaction Manager）和（局部）资源管理器（Resource Manager）之间的接口。XA接口是双向的系统接口，在书屋管理器（Transaction Manager）以及一个或多个资源管理器(Resource Manager)之间形成通信桥梁。XA之所以需要引入事务管理器是因为，在分布式系统中，从理论上将（参考Fischer等的论文），两台机器理论上无法达到一直的状态，需要引入一个单点进行协调。事务管理器控制者全局事务，管理事务声明周期，并协调资源。资源管理器负责控制和管理实际资源（如数据库或JMS队列）。

##   2.  两阶段提交
所有关于分布式事务的介绍中都必然会降到连接段提交，因为它是实现XA分布式事务的关键(确切的说：两阶段提交主要保证了分布式事务的原子性：即所有节点要么全做要么全不做)。所谓的两个阶段是指：第一阶段准备阶段和第二阶段提交阶段。
-   1.  准备阶段：
事务协调者（事务管理器）给每个参与者（资源管理器）发送Prepare消息，每个参与者要么直接返回失败（如权限验证失败）。要么在本地执行事务，写本地的redo和undo日志，但不提交，达到一种“万事俱备，只欠东风”的状态。
-   2.  提交阶段：
如果协调者收到了参与者的失败消息或者超时，直接给每个参与者发送回滚（rollback）消息；否则，发送提交(commit)消息；参与者根据协调者的失灵执行提交或者回滚操作，释放所有事务处理过程中使用的锁资源。（注意：必须在最后阶段释放锁资源）

将提交分成两个阶段进行的目的很明确，就是尽可能晚的提交事务，让事务在提交前尽可能地完成所有能完成的工作,这样的提交阶段将是一个耗时极端的微小操作，这种操作在一个分布式系统中失败的改了是非常小的，也就是所谓的“网络通讯危险期”非常的短暂，这是两阶段提交确保分布式事务原子性的关键所在。（唯一理论上两阶段提交出现问题的情况是当协调者发出提交指令后宕机并出现磁盘故障等永久性错误，导致事务不可追踪和恢复）

##   3.  一阶段提交（BestEfforts 1PC模式）
不像两阶段提交那样复杂，一阶段提交非常直白，就是从应用程序向数据库发出提交请求到数据库完成提交或者回滚之后将结果返回给应用程序的过程。一阶段提交不需要“协调者角色”，各节点之间不存在协调操作，因此其事务执行时间比亮阶段提交要端，但是提交的“危险期”是每一个事务的实际提交时间，相比于两阶段提交，一阶段提交出现在“不一致”的改了就变大了。但是我们必须注意到：只有当基础设施出现问题的时候（如网络终端，宕机等），一阶段提交才可能会出现不一致的情况。

##  4.  事务补偿机制
像best efforts 1PC这种模式，前提是应用程序能获取所有的数据源，然后使用同一个事务管理器管理事务。这种模式最典型的应用场景非数据库sharding莫属。但是对于那些基于web service/rpc/jms等构建的高度自治的分布式系统接口，Best efforts 1PC 模式是无能为例的。在此仓井下，还有最后一种方法可以帮助我们实现“最终一致性”，那就是事务补偿机制。

##  5.  在基于两阶段提交的标准分布式事务和Best Effort 1PC两者间如果选择
一般而言，需要交互的子系统数据较少，并且整个系统在未来不会或很少引入鑫的子系统切负载长期保持问题，即无伸缩要求的话，考虑到开发复杂度和工作量，可以选择使用分布式事务。对于时间需求不是很紧，对性能要求很高的系统，应考虑使用Best Effort 1PC或者事务补偿机制。